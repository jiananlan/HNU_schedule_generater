<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>湖南大学教务系统课表转ics(手机日历导入)</title>
</head>
<body>
  <h1><p style="color: red;">[尚未完工]</p>湖南大学教务系统课表转ics(手机日历导入)</h1>
  <form id="uploadForm">
    <input type="email" name="email" placeholder="请输入邮箱" required><br><br>
    <input type="file" name="file" accept=".xls,.xlsx" required><br><br>
    <button type="submit">上传并转换</button><br><br><hr>
    上传指南：<br>
    ①登陆湖南大学教务系统；<br>
    ②我的选课-课表查看-打印<br>
    ③上传下载的 xlsx格式课表文件<br>
    ④填写邮箱————以邮件的形式发送便于导入（苹果手机建议默认邮箱app）<br>
    ⑤点击收到的邮件的附件，导入到日历<br>
  </form>
  <p id="status"></p>

  <script>
    document.getElementById('uploadForm').onsubmit = async function (e) {
      e.preventDefault();
      const formData = new FormData(this);
      document.getElementById('status').innerText = '正在上传...';

      const response = await fetch("http://116.205.175.190:5000/api/upload", {
        method: "POST",
        body: formData
      });

      if (response.ok) {
        document.getElementById('status').innerText = '上传成功，请查收邮件！';
      } else {
        document.getElementById('status').innerText = '上传失败，请稍后再试。';
      }
    };
  </script>
</body>
</html>
